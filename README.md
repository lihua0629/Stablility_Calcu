# 船舶浮力体恢复力臂计算软件

这是一个用于计算船舶不同横倾角下浮力体恢复力臂的软件。本软件可以处理单个或多个浮力体组合的恢复力臂计算，支持从文件读取浮力数据，并提供图形化界面显示计算结果。

## 功能特点

- 支持多个部件的质量和质心数据输入
- 从文件读取不同横倾角下的浮力和浮力心坐标
- 自动计算综合质心和浮力心
- 实时计算并显示恢复力臂数据
- 图形化显示恢复力臂曲线
- 标注最大正值和最小负值点
- 精确度达到0.001米
- 支持坐标单位转换（输入单位：mm，计算单位：m）

## 安装说明

1. 确保已安装Python 3.x
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

## 数据文件格式

浮力和浮力心坐标数据文件要求：
1. 文本文件格式（.txt）
2. 第一行为标题行
3. 第二行为表头
4. 从第三行开始为数据，格式如下：
```
度 φ (°) 浮力 浮心坐标 (Xb,Yb,Zb)
角度 浮力值 X坐标 Y坐标 Z坐标
0° 650 1093 0 -89.4
10° 650 1080 107.9 -80
...
```

注意：
- 坐标单位为毫米（mm）
- 浮力单位为牛顿（N）
- 角度范围通常为0-90度

## 使用方法

1. 运行程序：
   ```bash
   python main.py
   ```

2. 添加部件：
   - 输入部件名称
   - 输入质量（kg）
   - 输入质心坐标（mm）
   - 选择对应的浮力数据文件
   - 点击"添加部件"按钮

3. 查看结果：
   - 程序会自动计算并显示恢复力臂数据
   - 在图表中显示恢复力臂曲线
   - 标注最大正值和最小负值点

4. 其他功能：
   - 可以删除已添加的部件
   - 可以清空所有数据重新开始
   - 可以关闭自动计算，手动触发计算

## 计算公式

恢复力臂计算公式：
```
l = Yb×cos(φ) + Zb×sin(φ) - ZG×sin(φ)
```

其中：
- Yb, Zb: 浮心的横向和垂向坐标（m）
- ZG: 质心的垂向坐标（m）
- φ: 横倾角度（弧度）
- l: 恢复力臂（m）

多个部件的综合计算：
1. 质心坐标：加权平均值（以质量为权重）
2. 浮心坐标：加权平均值（以浮力为权重）

## 依赖项

- Python 3.x
- tkinter (Python标准库)
- pandas >= 1.3.0
- numpy >= 1.21.0
- matplotlib >= 3.4.0

## 注意事项

1. 坐标系统：
   - 输入坐标单位为毫米（mm）
   - 程序内部自动转换为米（m）进行计算
   - 结果显示单位为米（m）

2. 数据文件：
   - 确保数据文件格式正确
   - 支持带括号和不带括号的坐标格式
   - 支持全角和半角负号

3. 计算结果：
   - 恢复力臂可以为正值或负值
   - 正值表示稳定趋势
   - 负值表示倾覆趋势

## 常见问题

1. 如果出现中文显示乱码：
   - 确保数据文件使用UTF-8编码
   - 检查系统是否安装了中文字体

2. 如果数据文件读取失败：
   - 检查文件格式是否符合要求
   - 检查数值是否有效
   - 检查文件编码格式

## 更新历史

### v1.0.0 (2024-03)
- 初始版本发布
- 支持基本的恢复力臂计算功能
- 提供图形化界面
- 支持多部件组合计算 